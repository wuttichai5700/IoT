<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infographic: IoT (Interactive Light Theme)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }
        header {
            position: relative;
        }
        .header-content {
            position: relative;
            z-index: 1;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
        }
        .card {
            background-color: white;
            border: 1px solid #e5e7eb;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid transparent;
            border-radius: 0.75rem; /* 12px */
            transition: border-color 0.3s ease;
            pointer-events: none;
        }
        .card:hover::before {
            border-color: #3b82f6;
        }
        .loader {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .fade-in-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        .action-button {
            transition: all 0.2s ease;
        }
        .action-button:hover {
            transform: scale(1.05);
        }
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease;
        }
        .dropdown-content {
            max-height: 200px;
            overflow-y: auto;
        }
        .typewriter-cursor {
            display: inline-block;
            width: 8px;
            height: 1.2em;
            background-color: #3b82f6;
            animation: blink 0.7s infinite;
            margin-left: 2px;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        /* Timeline Styles */
        .timeline-wrapper {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 1rem; /* for scrollbar */
        }
        .timeline-container {
            position: relative;
            padding: 2rem 0;
        }
        .timeline-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: #d1d5db;
            transform: translateX(-50%);
        }
        .timeline-item {
            position: relative;
            width: 50%;
            padding-bottom: 2rem;
        }
        .timeline-item:nth-child(odd) {
            left: 0;
            padding-right: 2rem;
            text-align: right;
        }
        .timeline-item:nth-child(even) {
            left: 50%;
            padding-left: 2rem;
        }
        .timeline-dot {
            position: absolute;
            top: 0;
            width: 20px;
            height: 20px;
            background-color: white;
            border: 4px solid #3b82f6;
            border-radius: 50%;
            z-index: 10;
        }
        .timeline-item:nth-child(odd) .timeline-dot {
            right: -10px;
        }
        .timeline-item:nth-child(even) .timeline-dot {
            left: -10px;
        }
        .timeline-content {
            background-color: #eef2ff;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid #c7d2fe;
        }
        /* Accessibility Helper */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-16 py-20">
            <div class="header-content">
                <h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-3">Internet of Things</h1>
                <p class="text-lg md:text-xl text-blue-600">เชื่อมต่ออนาคตด้วยปลายนิ้ว</p>
            </div>
        </header>

        <main class="space-y-16">

            <section class="card rounded-xl shadow-md p-6 md:p-8 text-center fade-in-section">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">การเติบโตสู่มิติใหม่</h2>
                <p class="max-w-3xl mx-auto text-gray-600 mb-8">
                    คาดการณ์ว่าภายในปี 2030 จะมีอุปกรณ์ IoT มากกว่า 4.1 หมื่นล้านชิ้นทั่วโลก ขับเคลื่อนการเปลี่ยนแปลงครั้งใหญ่ทั้งในระดับธุรกิจและชีวิตประจำวัน
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gray-100 p-6 rounded-lg border border-gray-200">
                        <p class="text-5xl md:text-7xl font-bold text-gray-900" data-count="27">0</p>
                        <p class="text-lg font-semibold text-blue-600">พันล้าน+ อุปกรณ์ในปี 2025</p>
                    </div>
                    <div class="bg-gray-100 p-6 rounded-lg border border-gray-200">
                        <p class="text-5xl md:text-7xl font-bold text-gray-900" data-count="41">0</p>
                        <p class="text-lg font-semibold text-blue-600">พันล้าน+ อุปกรณ์ในปี 2030</p>
                    </div>
                </div>
            </section>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 fade-in-section">
                <div class="card rounded-xl shadow-md p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">แนวโน้มการเติบโตของอุปกรณ์</h2>
                    <div class="chart-container">
                        <canvas id="growthChart"></canvas>
                    </div>
                </div>
                <div class="card rounded-xl shadow-md p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">สัดส่วนตลาด IoT ตามการใช้งาน</h2>
                    <div class="chart-container">
                        <canvas id="marketShareChart"></canvas>
                    </div>
                </div>
            </div>

            <section class="card rounded-xl shadow-md p-6 md:p-8 fade-in-section z-10">
                <h2 class="text-3xl font-bold text-gray-900 text-center mb-8">สำรวจอุปกรณ์ IoT ยอดนิยม</h2>
                <p class="text-gray-600 mb-8 text-center max-w-2xl mx-auto">พิมพ์เพื่อค้นหา และคลิกเลือกอุปกรณ์เพื่อดูรายละเอียด</p>
                <div class="relative max-w-lg mx-auto" id="search-container">
                    <label for="device-search-input" class="sr-only">ค้นหาอุปกรณ์ IoT</label>
                    <input type="text" id="device-search-input" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ค้นหาอุปกรณ์ เช่น 'ESP32'...">
                    <div id="device-dropdown" class="absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg hidden dropdown-content">
                    </div>
                </div>
            </section>

            <section class="card rounded-xl shadow-md p-6 md:p-8 fade-in-section">
                <h2 class="text-3xl font-bold text-gray-900 text-center mb-8">ไทม์ไลน์ประวัติศาสตร์ IoT</h2>
                <div class="timeline-wrapper">
                    <div class="timeline-container">
                        <div class="timeline-line"></div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">1999</h3>
                                <p class="text-sm">Kevin Ashton ได้บัญญัติคำว่า "Internet of Things" ขึ้นเป็นครั้งแรก</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">2008</h3>
                                <p class="text-sm">จำนวน "สิ่งของ" ที่เชื่อมต่ออินเทอร์เน็ตมีมากกว่าจำนวนประชากรโลกเป็นครั้งแรก</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">2010</h3>
                                <p class="text-sm">Nest Learning Thermostat เปิดตัว ทำให้แนวคิด Smart Home เป็นที่รู้จักในวงกว้าง</p>
                            </div>
                        </div>
                         <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">2014</h3>
                                <p class="text-sm">Amazon เปิดตัว Echo พร้อมผู้ช่วยเสียง Alexa ซึ่งปฏิวัติการสั่งงานอุปกรณ์ในบ้าน</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">2016</h3>
                                <p class="text-sm">การโจมตีของ Mirai botnet ทำให้ทั่วโลกตระหนักถึงความเสี่ยงด้านความปลอดภัยของ IoT</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">2022</h3>
                                <p class="text-sm">มาตรฐาน "Matter" เปิดตัวอย่างเป็นทางการ เพื่อให้อุปกรณ์ Smart Home ต่างยี่ห้อทำงานร่วมกันได้</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h3 class="font-bold text-lg">2025</h3>
                                <p class="text-sm">เทรนด์ Edge AI มาแรง ทำให้อุปกรณ์ IoT สามารถประมวลผลข้อมูลที่ซับซ้อนได้ด้วยตัวเอง โดยไม่ต้องส่งไปที่คลาวด์</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="card rounded-xl shadow-md p-6 md:p-8 fade-in-section">
                <h2 class="text-3xl font-bold text-gray-900 text-center mb-8">กรณีศึกษาความสำเร็จในไทย</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg text-green-600 mb-2 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M17.712 10.212A7 7 0 015.968 2.288a3 3 0 013.404-4.242.5.5 0 01.62.316l.5 1.5a.5.5 0 01-.316.62A5.5 5.5 0 005.5 7.512l-1.5-.5a.5.5 0 01-.316-.62A3 3 0 017.928 3a.5.5 0 01.38-.62l1.5-.5a.5.5 0 01.62.316A7 7 0 0117.712 10.212zM10 12a2 2 0 100-4 2 2 0 000 4z" />
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.93 15.07A6 6 0 0115.07 4.93 6 6 0 014.93 15.07z" clip-rule="evenodd" />
                            </svg>
                            Smart Farm ที่เชียงใหม่
                        </h3>
                        <p class="text-gray-600">ฟาร์มเมล่อนใช้เซ็นเซอร์วัดความชื้นดินและสภาพอากาศ เพื่อสั่งการระบบให้น้ำและปุ๋ยอัตโนมัติ ผลลัพธ์คือได้ผลผลิตคุณภาพสูงสม่ำเสมอ ลดการใช้น้ำและปุ๋ยเกินความจำเป็น</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg text-blue-600 mb-2 flex items-center">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 4h5m-5 4h5m-5-4a1 1 0 01-1-1v-1a1 1 0 112 0v1a1 1 0 01-1 1zm5 0a1 1 0 01-1-1v-1a1 1 0 112 0v1a1 1 0 01-1 1z" />
                           </svg>
                            Smart Factory ในระยอง
                        </h3>
                        <p class="text-gray-600">โรงงานติดตั้งเซ็นเซอร์บนเครื่องจักรเพื่อเก็บข้อมูลการทำงานแบบเรียลไทม์ ทำให้สามารถคาดการณ์การบำรุงรักษาล่วงหน้า ลดเวลาที่เครื่องจักรหยุดทำงาน และเพิ่มประสิทธิภาพการผลิต</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg text-red-600 mb-2 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Smart Hospital ในกรุงเทพฯ
                        </h3>
                        <p class="text-gray-600">โรงพยาบาลใช้ Tag RFID ติดตามตำแหน่งเครื่องมือแพทย์ราคาแพง และใช้ระบบคิวอัจฉริยะแจ้งเตือนผู้ป่วยผ่านแอปพลิเคชัน ช่วยลดเวลาการรอคอยและเพิ่มประสิทธิภาพการจัดการทรัพยากร</p>
                    </div>
                     <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg text-yellow-600 mb-2 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10l2-2h8a1 1 0 001-1zM21 12h-6" />
                            </svg>
                            Smart Logistics ทั่วประเทศ
                        </h3>
                        <p class="text-gray-600">บริษัทขนส่งติดตั้ง GPS และเซ็นเซอร์วัดอุณหภูมิบนรถบรรทุกห้องเย็น ทำให้สามารถติดตามตำแหน่งและควบคุมคุณภาพของสินค้า (เช่น อาหาร, ยา) ได้ตลอดเส้นทาง</p>
                    </div>
                </div>
            </section>

            <section class="card rounded-xl shadow-md p-6 md:p-8 fade-in-section bg-blue-50 border-blue-200">
                 <h2 class="text-3xl font-bold text-gray-900 text-center mb-8">เครื่องมือ AI อัจฉริยะ</h2>
                 <div class="space-y-12">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 text-center mb-2 flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                            สำรวจไอเดีย IoT ด้วย AI
                        </h3>
                        <p class="text-gray-600 mb-6 text-center max-w-2xl mx-auto">เลือกหมวดหมู่ที่คุณสนใจ แล้วให้ Gemini ช่วยสร้างสรรค์กรณีการใช้งาน (Use Case) ใหม่ๆ</p>
                        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-6">
                            <select id="useCaseSector" class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full sm:w-auto p-2.5">
                                <option value="Healthcare">การแพทย์</option>
                                <option value="Agriculture">เกษตรกรรม</option>
                                <option value="Smart Home">บ้านอัจฉริยะ</option>
                                <option value="Smart City">เมืองอัจฉริยะ</option>
                                <option value="Retail">ค้าปลีก</option>
                            </select>
                            <button id="generateIdeaBtn" class="w-full sm:w-auto text-white bg-purple-600 hover:bg-purple-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center action-button">✨ สร้างไอเดีย</button>
                        </div>
                        <div id="ideaLoader" class="hidden"><div class="loader"></div></div>
                        <div id="ideaResult" class="mt-4 p-5 bg-white border-l-4 border-purple-500 rounded-r-lg min-h-[100px] text-gray-600 whitespace-pre-wrap" aria-live="polite"></div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 text-center mb-2 flex items-center justify-center gap-2">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" /></svg>
                            เครื่องมือสร้างโค้ด Arduino ด้วย AI
                        </h3>
                        <p class="text-gray-600 mb-6 text-center max-w-2xl mx-auto">อธิบายสิ่งที่คุณต้องการให้บอร์ด Arduino ทำ แล้ว AI จะช่วยสร้างโค้ดเบื้องต้นให้คุณ สามารถคัดลอกไปใช้งานได้ทันที</p>
                        <div class="mb-4">
                            <label for="arduinoPrompt" class="block mb-2 text-sm font-medium text-gray-900">อธิบายโปรเจกต์ของคุณที่นี่:</label>
                            <textarea id="arduinoPrompt" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-white rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500" placeholder="เช่น 'โค้ดสำหรับเปิด/ปิดไฟ LED ที่ขา 13 ทุกๆ 1 วินาที'"></textarea>
                        </div>
                        <div class="text-center mb-6">
                            <button id="generateCodeBtn" class="text-white bg-blue-600 hover:bg-blue-700 font-medium rounded-lg text-sm px-8 py-3 text-center action-button">🚀 สร้างโค้ด</button>
                        </div>
                        <div id="codeLoader" class="hidden"><div class="loader"></div></div>
                        <div id="codeResultWrapper" class="hidden">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-semibold text-gray-800">โค้ด Arduino ที่สร้างขึ้น:</h3>
                                <button id="copyCodeBtn" class="text-sm bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-3 rounded-lg flex items-center action-button">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                    <span id="copyBtnText">คัดลอกโค้ด</span>
                                </button>
                            </div>
                            <pre class="bg-gray-900 text-white p-4 rounded-lg overflow-x-auto"><code id="codeResult"></code></pre>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-bold text-gray-800 text-center mb-2 flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3h3m-3 4h3m-3 4h3m-3 4h3" />
                            </svg>
                            ข่าวสารและเทรนด์ล่าสุด
                        </h3>
                        <p class="text-gray-600 mb-6 text-center max-w-2xl mx-auto">อัปเดตความเคลื่อนไหวล่าสุดในโลกของ IoT ด้วยข้อมูลสรุปจาก AI</p>
                        <div class="text-center mb-6">
                            <button id="getTrendsBtn" class="text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center action-button">🚀 อัปเดตเทรนด์</button>
                        </div>
                        <div id="trendsLoader" class="hidden"><div class="loader"></div></div>
                        <div id="trendsResult" class="mt-4 p-5 bg-white border-l-4 border-green-500 rounded-r-lg min-h-[100px] text-gray-600 whitespace-pre-wrap" aria-live="polite"></div>
                    </div>

                    <div>
                         <h3 class="text-2xl font-bold text-gray-800 text-center mb-2 flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            ถาม-ตอบเรื่อง IoT กับ AI
                        </h3>
                        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 my-6">
                            <input type="text" id="questionInput" class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" placeholder="พิมพ์คำถามของคุณที่นี่...">
                            <button id="askQuestionBtn" class="text-white bg-blue-600 hover:bg-blue-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center action-button">✨ ส่งคำถาม</button>
                        </div>
                        <div id="qaLoader" class="hidden"><div class="loader"></div></div>
                        <div id="qaResult" class="mt-4 p-5 bg-white border-l-4 border-blue-500 rounded-r-lg min-h-[100px] text-gray-600 whitespace-pre-wrap" aria-live="polite"></div>
                    </div>
                 </div>
            </section>
        </main>

        <footer class="text-center mt-16 py-6 border-t border-gray-200">
            <p class="text-sm text-gray-500">Interactive Light Theme by Gemini. Features powered by Google AI.</p>
        </footer>
    </div>

    <div id="device-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 hidden modal-overlay">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto modal-content scale-95">
            <div class="p-6">
                <div class="flex justify-between items-start">
                    <h3 id="modal-title" class="text-2xl font-bold text-gray-900"></h3>
                    <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
                </div>
                <div id="modal-body" class="mt-4">
                    </div>
            </div>
        </div>
    </div>

    <script>
        let growthChart, marketShareChart;
        let typewriterInterval;

        // --- ภายใน <script> ---

const chartColors = {
    light: {
        font: '#111827',
        grid: 'rgba(55, 65, 81, 0.1)',
        line: '#2563eb',
        lineBg: 'rgba(59, 130, 246, 0.1)',
        // --- ส่วนที่แก้ไข ---
        // ของเดิม: doughnutBg: ['#1d4ed8', '#2563eb', '#60a5fa', '#93c5fd', '#bfdbfe'],
        doughnutBg: [ // <-- ชุดสีใหม่
            '#3b82f6', // สีน้ำเงิน (อุตสาหกรรม)
            '#10b981', // สีเขียว (ผู้บริโภค)
            '#ef4444', // สีแดง (การแพทย์)
            '#8b5cf6', // สีม่วง (เมืองอัจฉริยะ)
            '#f59e0b'  // สีส้ม (ยานยนต์)
        ],
        doughnutBorder: '#ffffff'
    },
    dark: {
        font: '#d1d5db',
        grid: 'rgba(255, 255, 255, 0.1)',
        line: '#60a5fa',
        lineBg: 'rgba(96, 165, 250, 0.1)',
        // --- ส่วนที่แก้ไข ---
        // ของเดิม: doughnutBg: ['#3b82f6', '#60a5fa', '#93c5fd', '#bfdbfe', '#dbeafe'],
        doughnutBg: [ // <-- ชุดสีใหม่สำหรับ Dark Mode
            '#60a5fa', // สีน้ำเงิน
            '#34d399', // สีเขียว
            '#f87171', // สีแดง
            '#a78bfa', // สีม่วง
            '#fbbf24'  // สีส้ม
        ],
        doughnutBorder: '#1f2937'
    }
};

        const iotDevices = [
            { name: "Arduino UNO R3", image: "https://placehold.co/400x300/e0e0e0/333?text=Arduino+UNO", description: "บอร์ดไมโครคอนโทรลเลอร์ยอดนิยมสำหรับผู้เริ่มต้น เป็นหัวใจหลักของโปรเจกต์ IoT จำนวนมาก ใช้ในการอ่านค่าจากเซ็นเซอร์และควบคุมอุปกรณ์ต่างๆ", datasheet: "https://docs.arduino.cc/hardware/uno-rev3" },
            { name: "ESP32 Dev Kit", image: "https://placehold.co/400x300/e0e0e0/333?text=ESP32", description: "บอร์ดไมโครคอนโทรลเลอร์ประสิทธิภาพสูงที่มี Wi-Fi และ Bluetooth ในตัว เหมาะสำหรับโปรเจกต์ที่ต้องการการเชื่อมต่อไร้สาย", datasheet: "https://www.espressif.com/sites/default/files/documentation/esp32_datasheet_en.pdf" },
            { name: "DHT11 Sensor", image: "https://placehold.co/400x300/e0e0e0/333?text=DHT11", description: "เซ็นเซอร์สำหรับวัดอุณหภูมิและความชื้นในอากาศ ราคาถูกและใช้งานง่าย นิยมใช้ในโปรเจกต์สถานีวัดอากาศหรือระบบควบคุมความชื้น", datasheet: "https://www.mouser.com/datasheet/2/758/DHT11-Technical-Data-Sheet-Translated-Version-1143054.pdf" },
            { name: "PIR Motion Sensor", image: "https://placehold.co/400x300/e0e0e0/333?text=PIR+Sensor", description: "เซ็นเซอร์ตรวจจับการเคลื่อนไหวโดยใช้รังสีอินฟราเรด เหมาะสำหรับโปรเจกต์ระบบรักษาความปลอดภัยหรือระบบเปิด-ปิดไฟอัตโนมัติ", datasheet: "https://cdn-shop.adafruit.com/datasheets/HC-SR501.pdf" },
            { name: "Raspberry Pi 4", image: "https://placehold.co/400x300/e0e0e0/333?text=Raspberry+Pi", description: "คอมพิวเตอร์ขนาดเล็กที่มีประสิทธิภาพสูง สามารถรันระบบปฏิบัติการเต็มรูปแบบได้ เหมาะสำหรับโปรเจกต์ IoT ที่ซับซ้อน เช่น การประมวลผลภาพ หรือเซิร์ฟเวอร์ขนาดเล็ก", datasheet: "https://www.raspberrypi.com/products/raspberry-pi-4-model-b/specifications/" },
            { name: "Servo Motor SG90", image: "https://placehold.co/400x300/e0e0e0/333?text=Servo+Motor", description: "มอเตอร์ที่สามารถควบคุมการหมุนได้อย่างแม่นยำในมุมที่กำหนด (ปกติ 0-180 องศา) ใช้ในโปรเจกต์แขนกล, หุ่นยนต์, หรือการเปิด-ปิดวาล์ว", datasheet: "https://components101.com/motors/sg90-servo-motor" },
            { name: "Relay Module", image: "https://placehold.co/400x300/e0e0e0/333?text=Relay+Module", description: "สวิตช์ไฟฟ้าที่ควบคุมด้วยสัญญาณไฟฟ้าแรงดันต่ำ ทำให้ไมโครคอนโทรลเลอร์สามารถเปิด-ปิดอุปกรณ์ที่ใช้ไฟฟ้าแรงสูง (เช่น ไฟบ้าน, พัดลม) ได้อย่างปลอดภัย", datasheet: "https://www.makerlab.co/blogs/learning/relay-module" },
            { name: "Ultrasonic Sensor", image: "https://placehold.co/400x300/e0e0e0/333?text=Ultrasonic", description: "เซ็นเซอร์วัดระยะทางโดยใช้คลื่นเสียงอัลตราโซนิก เหมาะสำหรับโปรเจกต์หุ่นยนต์หลบหลีกสิ่งกีดขวาง, ระบบวัดระดับน้ำ, หรือระบบช่วยจอดรถ", datasheet: "https://cdn.sparkfun.com/datasheets/Sensors/Proximity/HCSR04.pdf" }
        ];

        document.addEventListener("DOMContentLoaded", () => {
            particlesJS('particles-js', {
                "particles": { "number": { "value": 80, "density": { "enable": true, "value_area": 800 } }, "color": { "value": "#3b82f6" }, "shape": { "type": "circle" }, "opacity": { "value": 0.5, "random": false }, "size": { "value": 3, "random": true }, "line_linked": { "enable": true, "distance": 150, "color": "#3b82f6", "opacity": 0.4, "width": 1 }, "move": { "enable": true, "speed": 2, "direction": "none", "random": false, "straight": false, "out_mode": "out" } },
                "interactivity": { "detect_on": "canvas", "events": { "onhover": { "enable": true, "mode": "repulse" }, "onclick": { "enable": true, "mode": "push" }, "resize": true }, "modes": { "repulse": { "distance": 150, "duration": 0.4 }, "push": { "particles_nb": 4 } } },
                "retina_detect": true
            });

            const sections = document.querySelectorAll('.fade-in-section');
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        const counters = entry.target.querySelectorAll('[data-count]');
                        counters.forEach(counter => {
                            if (counter.innerText === '0') {
                                animateCountUp(counter);
                            }
                        });
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            sections.forEach(section => { observer.observe(section); });

            const growthChartCtx = document.getElementById('growthChart').getContext('2d');
            growthChart = new Chart(growthChartCtx, {
                type: 'line', data: { labels: ['2020', '2022', '2024', '2025', '2026', '2028', '2030'], datasets: [{ label: 'จำนวนอุปกรณ์ (พันล้านชิ้น)', data: [11.3, 14.4, 20.1, 27.1, 30.9, 36.2, 41.6], backgroundColor: chartColors.lineBg, borderColor: chartColors.line, pointBackgroundColor: '#ffffff', pointBorderColor: chartColors.line, tension: 0.4, fill: true, }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { color: chartColors.font }, grid: { color: chartColors.grid } }, x: { ticks: { color: chartColors.font }, grid: { color: chartColors.grid } } }, plugins: { legend: { display: false } } }
            });

            const marketShareChartCtx = document.getElementById('marketShareChart').getContext('2d');
            marketShareChart = new Chart(marketShareChartCtx, {
                type: 'doughnut', data: { labels: ['อุตสาหกรรม', 'ผู้บริโภค', 'การแพทย์', 'เมืองอัจฉริยะ', 'ยานยนต์'], datasets: [{ label: 'สัดส่วนตลาด', data: [35, 30, 15, 12, 8], backgroundColor: chartColors.doughnutBg, borderColor: chartColors.doughnutBorder, borderWidth: 4, hoverOffset: 20 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: chartColors.font } } } }
            });

            initDeviceExplorer();
        });
        
        const functionUrl = "/.netlify/functions/call-gemini";

        async function callGeminiAPI(prompt, loaderElement, resultElement, isCode = false, wrapperElement = null) {
            loaderElement.style.display = 'block';
            if (wrapperElement) wrapperElement.style.display = 'none';
            if(resultElement) resultElement.innerHTML = '';
            
            try {
                const response = await fetch(functionUrl, { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }, 
                    body: JSON.stringify({ prompt: prompt })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Error calling Netlify function');
                }

                const result = await response.json();

                if (result.candidates?.[0]?.content?.parts?.[0]) {
                    let text = result.candidates[0].content.parts[0].text;
                    if (isCode) {
                        text = text.replace(/^```(cpp|c\+\+|arduino)?\s*/, '').replace(/```\s*$/, '');
                        resultElement.textContent = text.trim();
                        if (wrapperElement) wrapperElement.style.display = 'block';
                    } else {
                        // For markdown-formatted text, we can use a library or a simple conversion
                        // Here, we just replace some markdown for simple HTML display
                        let htmlText = text
                            .replace(/### (.*)/g, '<h3 class="text-lg font-semibold mt-2">$1</h3>')
                            .replace(/## (.*)/g, '<h2 class="text-xl font-bold mt-3">$1</h2>')
                            .replace(/# (.*)/g, '<h1 class="text-2xl font-bold mt-4">$1</h1>')
                            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                            .replace(/\* (.*)/g, '<li class="ml-4 list-disc">$1</li>');
                        typewriterEffect(resultElement, htmlText, 15);
                    }
                } else {
                    console.error('Invalid response structure:', result);
                    let errorMessage = 'ขออภัย ไม่สามารถสร้างคำตอบได้ในขณะนี้';
                    if (result.promptFeedback && result.promptFeedback.blockReason) {
                        errorMessage += ` (เหตุผล: ${result.promptFeedback.blockReason})`;
                    }
                    typewriterEffect(resultElement, errorMessage);
                }
            } catch (error) {
                console.error('API call failed:', error);
                typewriterEffect(resultElement, `เกิดข้อผิดพลาดในการเชื่อมต่อกับ AI: ${error.message}. กรุณาลองใหม่อีกครั้ง`);
            } finally {
                loaderElement.style.display = 'none';
            }
        }

        function typewriterEffect(element, text, speed = 20) {
            if (typewriterInterval) clearInterval(typewriterInterval);
            element.innerHTML = '';
            let i = 0;
            const cursor = document.createElement('span');
            cursor.className = 'typewriter-cursor';
            element.appendChild(cursor);

            // A simple way to handle HTML tags during typing
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = text;
            const allNodes = Array.from(tempDiv.childNodes);
            let currentNodeIndex = 0;
            let currentText = '';
            let charIndex = 0;
            
            function type() {
                if (currentNodeIndex < allNodes.length) {
                    const currentNode = allNodes[currentNodeIndex];
                    if (currentNode.nodeType === Node.TEXT_NODE) {
                        currentText = currentNode.textContent;
                        if (charIndex < currentText.length) {
                            element.insertBefore(document.createTextNode(currentText[charIndex]), cursor);
                            charIndex++;
                        } else {
                            charIndex = 0;
                            currentNodeIndex++;
                        }
                    } else { // It's an element
                        element.insertBefore(currentNode.cloneNode(true), cursor);
                        currentNodeIndex++;
                    }
                } else {
                     clearInterval(typewriterInterval);
                     if (cursor.parentNode) cursor.parentNode.removeChild(cursor);
                }
            }
            typewriterInterval = setInterval(type, speed);
        }

        function animateCountUp(el) {
            const target = parseInt(el.getAttribute('data-count'));
            el.innerText = '0';
            let current = 0;
            const duration = 2000;
            const stepTime = 20;
            const increment = target / (duration / stepTime);
            
            const interval = setInterval(() => {
                current += increment;
                if (current >= target) {
                    el.innerText = target;
                    clearInterval(interval);
                } else {
                    el.innerText = Math.ceil(current);
                }
            }, stepTime);
        }

        function openModal(title, content) {
            const modal = document.getElementById('device-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');

            modalTitle.textContent = title;
            modalBody.innerHTML = content;

            modal.classList.remove('hidden');
            setTimeout(() => { modal.querySelector('.modal-content').classList.remove('scale-95'); }, 10);
        }

        function initDeviceExplorer() {
            const searchInput = document.getElementById('device-search-input');
            const dropdown = document.getElementById('device-dropdown');
            
            const filterDevices = () => {
                const filter = searchInput.value.toUpperCase();
                dropdown.innerHTML = '';
                const filteredDevices = iotDevices.filter(d => d.name.toUpperCase().includes(filter));

                if(filteredDevices.length > 0) {
                    filteredDevices.forEach(device => {
                        const item = document.createElement('a');
                        item.href = '#';
                        item.className = 'block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100';
                        item.textContent = device.name;
                        item.addEventListener('click', (e) => {
                            e.preventDefault();
                            searchInput.value = device.name;
                            dropdown.classList.add('hidden');
                            const content = `
                                <div class="md:grid md:grid-cols-2 md:gap-6">
                                    <img src="${device.image}" alt="${device.name}" class="w-full h-auto object-contain rounded-lg mb-4 md:mb-0">
                                    <div>
                                        <p class="text-gray-600 mb-4">${device.description}</p>
                                        <a href="${device.datasheet}" target="_blank" rel="noopener noreferrer" class="inline-block w-full text-center text-white bg-blue-600 hover:bg-blue-700 font-medium rounded-lg text-sm px-5 py-2.5 action-button">
                                            ดู Datasheet
                                        </a>
                                    </div>
                                </div>`;
                            openModal(device.name, content);
                        });
                        dropdown.appendChild(item);
                    });
                     dropdown.classList.remove('hidden');
                } else {
                    dropdown.classList.add('hidden');
                }
            };
            
            searchInput.addEventListener('keyup', filterDevices);
            searchInput.addEventListener('focus', filterDevices);

            document.addEventListener('click', function(event) {
                const container = document.getElementById('search-container');
                if (!container.contains(event.target)) {
                    dropdown.classList.add('hidden');
                }
            });
        }
        
        const modal = document.getElementById('device-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const closeModal = () => {
             modal.querySelector('.modal-content').classList.add('scale-95');
             setTimeout(() => { modal.classList.add('hidden'); }, 300);
        };
        closeModalBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) { closeModal(); } });


        document.getElementById('generateIdeaBtn').addEventListener('click', () => {
            const sector = document.getElementById('useCaseSector').value;
            const prompt = `Generate a creative, specific, and practical new use case for IoT in the '${sector}' sector in Thailand. Respond in Thai using markdown format. Use a main heading for the idea title, and then use subheadings for '### ปัญหา (Problem)', '### แนวทางแก้ไขและอุปกรณ์ (Solution & Devices)', and '### ประโยชน์ (Benefit)'.`;
            callGeminiAPI(prompt, document.getElementById('ideaLoader'), document.getElementById('ideaResult'));
        });

        document.getElementById('generateCodeBtn').addEventListener('click', () => {
            const userPrompt = document.getElementById('arduinoPrompt').value;
            if (!userPrompt.trim()) { alert('กรุณาอธิบายโปรเจกต์ที่คุณต้องการ'); return; }
            const prompt = `You are an expert Arduino programmer. Based on the following user request, generate a complete, well-commented, and ready-to-use Arduino C++ code (.ino). The code should be enclosed in a single markdown code block. User request in Thai: '${userPrompt}'`;
            callGeminiAPI(prompt, document.getElementById('codeLoader'), document.getElementById('codeResult'), true, document.getElementById('codeResultWrapper'));
        });

        document.getElementById('copyCodeBtn').addEventListener('click', () => {
            const codeToCopy = document.getElementById('codeResult').innerText;
            navigator.clipboard.writeText(codeToCopy).then(() => {
                document.getElementById('copyBtnText').innerText = 'คัดลอกแล้ว!';
                setTimeout(() => { document.getElementById('copyBtnText').innerText = 'คัดลอกโค้ด'; }, 2000);
            }).catch(err => { console.error('Failed to copy text: ', err); });
        });

        document.getElementById('askQuestionBtn').addEventListener('click', () => {
            const question = document.getElementById('questionInput').value;
            if (!question.trim()) { document.getElementById('qaResult').textContent = 'กรุณาป้อนคำถามของคุณ'; return; }
            const prompt = `As an IoT expert, answer this question clearly and concisely in Thai: "${question}"`;
            callGeminiAPI(prompt, document.getElementById('qaLoader'), document.getElementById('qaResult'));
        });

        document.getElementById('getTrendsBtn').addEventListener('click', () => {
            const prompt = `Summarize 2-3 of the most important and recent trends in the world of Internet of Things as of August 2025. Respond in Thai. For each trend, use a bolded title (e.g., **1. Trend Name**) and then a short paragraph description.`;
            callGeminiAPI(prompt, document.getElementById('trendsLoader'), document.getElementById('trendsResult'));
        });
        
        // Set initial texts
        document.getElementById('ideaResult').innerHTML = '🤖 <strong>พร้อมสร้างสรรค์!</strong><br>เลือกหมวดหมู่แล้วกดปุ่ม "✨ สร้างไอเดีย" เพื่อให้ AI ช่วยคิดครับ';
        document.getElementById('qaResult').innerHTML = '🤔 <strong>มีคำถามใช่ไหม?</strong><br>พิมพ์ข้อสงสัยเกี่ยวกับ IoT ของคุณแล้วให้ AI ช่วยตอบได้เลย';
        document.getElementById('trendsResult').innerHTML = '📰 <strong>อยากรู้เทรนด์ล่าสุด?</strong><br>กดปุ่ม "🚀 อัปเดตเทรนด์" เพื่อดูความเคลื่อนไหวในโลก IoT';
    </script>
</body>
</html>
